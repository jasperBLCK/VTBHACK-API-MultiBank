# Интеграция базы данных

База данных теперь полностью интегрирована во все части приложения. Все данные сохраняются и загружаются из базы данных.

## Настройка

1. **Убедитесь, что `.env.local` содержит:**
   ```env
   DATABASE_URL="file:./dev.db"
   ```

2. **Инициализируйте базу данных:**
   ```bash
   npx prisma generate
   npx prisma db push
   npx prisma db seed
   ```

## Что было сделано

### API Routes
- ✅ `/api/accounts` - работа со счетами (GET, POST, PATCH)
- ✅ `/api/transactions` - работа с транзакциями (GET, POST)
- ✅ `/api/budgets` - работа с бюджетами (GET, POST, DELETE)
- ✅ `/api/notifications` - работа с уведомлениями (GET, POST, PATCH, DELETE)
- ✅ `/api/transfer` - выполнение переводов между счетами (POST)

### Интеграция в страницы
- ✅ Главная страница (`app/page.tsx`) - загрузка счетов, транзакций, уведомлений
- ✅ Страница бюджета (`app/budget/page.tsx`) - загрузка и сохранение бюджетов и трат
- ⏳ Страница аналитики - будет обновлена при необходимости
- ⏳ Страница истории - будет обновлена при необходимости
- ⏳ Страница счетов - будет обновлена при необходимости

### Модель данных
- ✅ Добавлена модель `Budget` в Prisma schema
- ✅ Все модели связаны с пользователем через `userId`

## Демо пользователь

Для демонстрации используется фиксированный `userId = 'demo-user-1'`. В продакшене это должно быть из сессии/аутентификации.

## Заполнение начальными данными

Скрипт `prisma/seed.ts` создает:
- Демо пользователя
- 2 счета (ВТБ и Сбербанк)
- Несколько транзакций
- 4 бюджета (Еда, Транспорт, Покупки, Счета)

Запуск: `npx prisma db seed`

## Важно

После изменения схемы Prisma:
1. `npx prisma generate` - перегенерировать клиент
2. `npx prisma db push` - применить изменения к БД
3. При необходимости: `npx prisma db seed` - заполнить начальными данными

